<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultra Pinnacle Studio - Autonomous Permission Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .permissions-dashboard {
            padding: 40px;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        .permissions-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .permission-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .permission-card.secure {
            border-color: #28a745;
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        }

        .permission-card.warning {
            border-color: #ffc107;
            background: linear-gradient(135deg, #fff3cd 0%, #fce4a3 100%);
        }

        .permission-card.danger {
            border-color: #dc3545;
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
        }

        .permission-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .permission-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .permission-value {
            font-size: 2rem;
            font-weight: bold;
            color: #333;
        }

        .permission-description {
            font-size: 0.9rem;
            color: #666;
            margin-top: 10px;
        }

        .ai-decision-engine {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .engine-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .engine-status {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .status-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #28a745;
        }

        .status-indicator.inactive {
            background: #dc3545;
        }

        .engine-controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .control-button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .access-request-simulator {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .simulator-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .request-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-weight: 500;
            margin-bottom: 8px;
            color: #333;
        }

        .form-input, .form-select {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 0.95rem;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #667eea;
        }

        .simulate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .simulate-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .decision-result {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            display: none;
        }

        .decision-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .decision-icon {
            font-size: 2rem;
            margin-right: 15px;
        }

        .decision-text {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .decision-allow {
            color: #28a745;
        }

        .decision-deny {
            color: #dc3545;
        }

        .decision-challenge {
            color: #ffc107;
        }

        .decision-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .detail-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
        }

        .detail-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
        }

        .detail-content {
            color: #555;
            line-height: 1.5;
        }

        .rules-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .rules-grid {
            display: grid;
            gap: 20px;
        }

        .rule-card {
            border: 2px solid #e1e5e9;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
        }

        .rule-card.ai-generated {
            border-color: #667eea;
            background: linear-gradient(135deg, #e8f2ff 0%, #f8f9ff 100%);
        }

        .rule-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .rule-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .rule-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge-ai {
            background: #667eea;
            color: white;
        }

        .badge-admin {
            background: #28a745;
            color: white;
        }

        .rule-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .rule-info {
            display: flex;
            flex-direction: column;
        }

        .rule-label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 5px;
        }

        .rule-value {
            font-weight: 600;
            color: #333;
        }

        .rule-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .user-permissions {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .permissions-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .user-selector {
            margin-bottom: 20px;
        }

        .user-selector select {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 0.95rem;
            margin-left: 10px;
        }

        .permissions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .permission-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .permission-item.read {
            border-color: #28a745;
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        }

        .permission-item.write {
            border-color: #17a2b8;
            background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);
        }

        .permission-item.admin {
            border-color: #dc3545;
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
        }

        .permission-resource {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .permission-level {
            font-size: 0.9rem;
            color: #666;
        }

        .back-links {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .back-link {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            display: none;
        }

        .notification.success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .notification.error {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        }

        .notification.warning {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
        }

        .notification.info {
            background: linear-gradient(135deg, #17a2b8 0%, #667eea 100%);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è Autonomous Permission Manager</h1>
            <p>AI-chosen safe defaults with contextual access controls</p>
        </div>

        <div class="permissions-dashboard">
            <div class="back-links">
                <a href="../auto_install/setup_interface.html" class="back-link">‚Üê Auto-Install</a>
                <a href="../domain_builder/domain_builder_ui.html" class="back-link">‚Üê Domain Builder</a>
                <a href="../universal_hosting/hosting_dashboard.html" class="back-link">‚Üê Universal Hosting</a>
                <a href="../auto_upgrader/updates_dashboard.html" class="back-link">‚Üê Auto-Updates</a>
                <a href="../self_healing/healing_dashboard.html" class="back-link">‚Üê Self-Healing</a>
                <a href="../cross_device_sync/sync_dashboard.html" class="back-link">‚Üê Cross-Device Sync</a>
                <a href="zero_trust_dashboard.html" class="back-link">‚Üê Zero-Trust AI</a>
            </div>

            <div class="permissions-overview">
                <div class="permission-card secure" id="totalRules">
                    <div class="permission-icon">üìã</div>
                    <div class="permission-title">Active Rules</div>
                    <div class="permission-value" id="rulesValue">24</div>
                    <div class="permission-description">Permission rules in effect</div>
                </div>

                <div class="permission-card secure" id="aiDecisions">
                    <div class="permission-icon">ü§ñ</div>
                    <div class="permission-title">AI Decisions</div>
                    <div class="permission-value" id="decisionsValue">156</div>
                    <div class="permission-description">AI-generated decisions today</div>
                </div>

                <div class="permission-card secure" id="accessRequests">
                    <div class="permission-icon">üîç</div>
                    <div class="permission-title">Access Requests</div>
                    <div class="permission-value" id="requestsValue">89</div>
                    <div class="permission-description">Total requests processed</div>
                </div>

                <div class="permission-card secure" id="securityScore">
                    <div class="permission-icon">‚≠ê</div>
                    <div class="permission-title">Security Score</div>
                    <div class="permission-value" id="scoreValue">98%</div>
                    <div class="permission-description">Permission system effectiveness</div>
                </div>
            </div>

            <div class="ai-decision-engine">
                <div class="engine-title">ü§ñ AI Decision Engine</div>
                <div class="engine-status">
                    <div class="status-indicator active"></div>
                    <span>AI decision engine is active and learning</span>
                </div>

                <div class="engine-controls">
                    <button class="control-button btn-primary" onclick="simulateAccessRequest()">üîç Simulate Request</button>
                    <button class="control-button btn-secondary" onclick="generateSafeDefaults()">‚öôÔ∏è Generate Defaults</button>
                    <button class="control-button btn-primary" onclick="analyzePatterns()">üìä Analyze Patterns</button>
                    <button class="control-button btn-secondary" onclick="createCustomRule()">‚ûï Create Rule</button>
                </div>
            </div>

            <div class="access-request-simulator">
                <div class="simulator-title">üîç Access Request Simulator</div>

                <div class="request-form">
                    <div class="form-group">
                        <label class="form-label">User ID:</label>
                        <input type="text" class="form-input" id="userId" value="user_123" placeholder="Enter user ID">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Resource:</label>
                        <select class="form-select" id="resource">
                            <option value="user_data">User Data</option>
                            <option value="admin_panel">Admin Panel</option>
                            <option value="system_files">System Files</option>
                            <option value="public_files">Public Files</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Action:</label>
                        <select class="form-select" id="action">
                            <option value="read">Read</option>
                            <option value="write">Write</option>
                            <option value="execute">Execute</option>
                            <option value="delete">Delete</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Context:</label>
                        <select class="form-select" id="context">
                            <option value="trusted">Trusted Environment</option>
                            <option value="suspicious">Suspicious Environment</option>
                            <option value="new_device">New Device</option>
                            <option value="unusual_time">Unusual Time</option>
                        </select>
                    </div>
                </div>

                <button class="simulate-btn" onclick="simulateRequest()">üöÄ Evaluate Access Request</button>

                <div class="decision-result" id="decisionResult">
                    <div class="decision-header">
                        <div class="decision-icon" id="decisionIcon">‚ùì</div>
                        <div class="decision-text" id="decisionText">Decision Pending</div>
                    </div>

                    <div class="decision-details">
                        <div class="detail-section">
                            <div class="detail-title">üìã Request Details</div>
                            <div class="detail-content" id="requestDetails">
                                User: user_123<br>
                                Resource: user_data<br>
                                Action: read<br>
                                Context: trusted
                            </div>
                        </div>

                        <div class="detail-section">
                            <div class="detail-title">ü§ñ AI Analysis</div>
                            <div class="detail-content" id="aiAnalysis">
                                Analyzing user behavior patterns...<br>
                                Evaluating contextual factors...<br>
                                Calculating risk score...
                            </div>
                        </div>

                        <div class="detail-section">
                            <div class="detail-title">‚öôÔ∏è Applied Rules</div>
                            <div class="detail-content" id="appliedRules">
                                Rule #1: User data access for verified users<br>
                                Rule #2: Standard user permissions<br>
                                Rule #3: Context-based access control
                            </div>
                        </div>

                        <div class="detail-section">
                            <div class="detail-title">üìä Decision Factors</div>
                            <div class="detail-content" id="decisionFactors">
                                Trust Level: Verified ‚úÖ<br>
                                Risk Score: Low (0.2) ‚úÖ<br>
                                Context: Appropriate ‚úÖ<br>
                                Behavior: Normal ‚úÖ
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="user-permissions">
                <div class="permissions-title">üë§ User Permissions</div>

                <div class="user-selector">
                    <label>Select User:</label>
                    <select id="userSelector" onchange="loadUserPermissions()">
                        <option value="user_123">User 123 (Standard)</option>
                        <option value="admin_001">Admin 001 (Administrator)</option>
                        <option value="power_user_456">Power User 456 (Advanced)</option>
                    </select>
                </div>

                <div class="permissions-grid" id="permissionsGrid">
                    <!-- User permissions will appear here -->
                </div>
            </div>

            <div class="rules-section">
                <div class="section-title">üìã Active Permission Rules</div>
                <div id="rulesContainer" class="rules-grid">
                    <!-- Rules will appear here -->
                </div>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Processing request...</p>
            </div>
        </div>
    </div>

    <div class="notification" id="notification">
        <span id="notificationMessage"></span>
    </div>

    <script>
        class PermissionsDashboard {
            constructor() {
                this.currentUser = 'user_123';
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.loadCurrentStatus();
                this.loadPermissionRules();
                this.loadUserPermissions();
            }

            setupEventListeners() {
                // Event listeners for interactive elements
            }

            async loadCurrentStatus() {
                try:
                    // In a real implementation, this would fetch from the permissions API
                    const status = await this.getMockPermissionStatus();
                    this.updateOverviewDisplay(status);
                } catch (error) {
                    console.error('Failed to load permission status:', error);
                }
            }

            async getMockPermissionStatus() {
                // Simulate API call delay
                await new Promise(resolve => setTimeout(resolve, 1000));

                return {
                    active_rules: 24,
                    ai_decisions_today: 156,
                    access_requests_today: 89,
                    security_score: 98
                };
            }

            updateOverviewDisplay(status) {
                document.getElementById('rulesValue').textContent = status.active_rules;
                document.getElementById('decisionsValue').textContent = status.ai_decisions_today;
                document.getElementById('requestsValue').textContent = status.access_requests_today;
                document.getElementById('scoreValue').textContent = status.security_score + '%';
            }

            async loadPermissionRules() {
                try:
                    // In a real implementation, this would fetch from the rules API
                    const rules = await this.getMockPermissionRules();
                    this.displayPermissionRules(rules);
                } catch (error) {
                    console.error('Failed to load permission rules:', error);
                }
            }

            async getMockPermissionRules() {
                // Simulate API call delay
                await new Promise(resolve => setTimeout(resolve, 1500));

                return [
                    {
                        rule_id: 'rule_001',
                        resource: 'user_data',
                        action: 'read',
                        conditions: { 'user_role': 'standard', 'trust_level': 'verified' },
                        decision: 'allow',
                        confidence: 0.95,
                        created_by: 'ai_engine',
                        reasoning: 'Standard users can read their own data when verified'
                    },
                    {
                        rule_id: 'rule_002',
                        resource: 'admin_panel',
                        action: 'access',
                        conditions: { 'user_role': 'admin' },
                        decision: 'allow',
                        confidence: 0.98,
                        created_by: 'admin',
                        reasoning: 'Only administrators can access admin panel'
                    },
                    {
                        rule_id: 'rule_003',
                        resource: 'system_files',
                        action: 'write',
                        conditions: { 'trust_level': 'suspicious' },
                        decision: 'deny',
                        confidence: 0.92,
                        created_by: 'ai_engine',
                        reasoning: 'Suspicious users cannot modify system files'
                    }
                ];
            }

            displayPermissionRules(rules) {
                const container = document.getElementById('rulesContainer');

                if (rules.length === 0) {
                    container.innerHTML = '<p>No permission rules configured.</p>';
                    return;
                }

                container.innerHTML = '';

                rules.forEach((rule, index) => {
                    const ruleCard = this.createRuleCard(rule, index);
                    container.appendChild(ruleCard);
                });
            }

            createRuleCard(rule, index) {
                const card = document.createElement('div');
                card.className = `rule-card ${rule.created_by === 'ai_engine' ? 'ai-generated' : ''}`;

                const badgeClass = rule.created_by === 'ai_engine' ? 'badge-ai' : 'badge-admin';
                const badgeText = rule.created_by === 'ai_engine' ? 'AI Generated' : 'Admin Created';

                card.innerHTML = `
                    <div class="rule-header">
                        <div class="rule-title">Rule #${rule.rule_id}</div>
                        <span class="rule-badge ${badgeClass}">${badgeText}</span>
                    </div>

                    <div class="rule-details">
                        <div class="rule-info">
                            <div class="rule-label">Resource</div>
                            <div class="rule-value">${rule.resource}</div>
                        </div>
                        <div class="rule-info">
                            <div class="rule-label">Action</div>
                            <div class="rule-value">${rule.action}</div>
                        </div>
                        <div class="rule-info">
                            <div class="rule-label">Decision</div>
                            <div class="rule-value">${rule.decision.toUpperCase()}</div>
                        </div>
                        <div class="rule-info">
                            <div class="rule-label">Confidence</div>
                            <div class="rule-value">${(rule.confidence * 100).toFixed(1)}%</div>
                        </div>
                    </div>

                    <div class="rule-actions">
                        <button class="btn btn-secondary" onclick="permissionsDashboard.editRule('${rule.rule_id}')">Edit</button>
                        <button class="btn btn-primary" onclick="permissionsDashboard.testRule('${rule.rule_id}')">Test</button>
                    </div>
                `;

                return card;
            }

            async loadUserPermissions() {
                const userSelector = document.getElementById('userSelector');
                this.currentUser = userSelector.value;

                try:
                    // In a real implementation, this would fetch from the permissions API
                    const permissions = await this.getMockUserPermissions(this.currentUser);
                    this.displayUserPermissions(permissions);
                } catch (error) {
                    console.error('Failed to load user permissions:', error);
                }
            }

            async getMockUserPermissions(userId) {
                // Simulate API call delay
                await new Promise(resolve => setTimeout(resolve, 1000));

                const permissionSets = {
                    'user_123': {
                        'user_data': 'read',
                        'public_files': 'read',
                        'system_files': 'none',
                        'admin_panel': 'none'
                    },
                    'admin_001': {
                        'user_data': 'admin',
                        'public_files': 'admin',
                        'system_files': 'admin',
                        'admin_panel': 'admin'
                    },
                    'power_user_456': {
                        'user_data': 'write',
                        'public_files': 'write',
                        'system_files': 'read',
                        'admin_panel': 'none'
                    }
                };

                return permissionSets[userId] || permissionSets['user_123'];
            }

            displayUserPermissions(permissions) {
                const container = document.getElementById('permissionsGrid');
                container.innerHTML = '';

                Object.entries(permissions).forEach(([resource, level]) => {
                    const permissionItem = this.createPermissionItem(resource, level);
                    container.appendChild(permissionItem);
                });
            }

            createPermissionItem(resource, level) {
                const item = document.createElement('div');
                item.className = `permission-item ${level}`;

                const levelText = level.charAt(0).toUpperCase() + level.slice(1);

                item.innerHTML = `
                    <div class="permission-resource">${resource.replace('_', ' ').toUpperCase()}</div>
                    <div class="permission-level">${levelText} Access</div>
                `;

                return item;
            }

            async simulateRequest() {
                const loading = document.getElementById('loading');
                const decisionResult = document.getElementById('decisionResult');

                loading.style.display = 'block';
                decisionResult.style.display = 'none';

                try:
                    const userId = document.getElementById('userId').value;
                    const resource = document.getElementById('resource').value;
                    const action = document.getElementById('action').value;
                    const context = document.getElementById('context').value;

                    // Simulate AI decision process
                    await this.mockDecisionProcess(userId, resource, action, context);

                    // Show decision result
                    decisionResult.style.display = 'block';

                } catch (error) {
                    console.error('Request simulation failed:', error);
                    this.showNotification('Request simulation failed', 'error');
                } finally {
                    loading.style.display = 'none';
                }
            }

            async mockDecisionProcess(userId, resource, action, context) {
                // Simulate AI analysis delay
                await new Promise(resolve => setTimeout(resolve, 2000));

                // Mock decision based on context
                let decision, icon, decisionClass;

                if (context === 'trusted') {
                    decision = 'ALLOW';
                    icon = '‚úÖ';
                    decisionClass = 'decision-allow';
                } else if (context === 'suspicious') {
                    decision = 'DENY';
                    icon = '‚ùå';
                    decisionClass = 'decision-deny';
                } else {
                    decision = 'CHALLENGE';
                    icon = '‚ö†Ô∏è';
                    decisionClass = 'decision-challenge';
                }

                // Update decision display
                document.getElementById('decisionIcon').textContent = icon;
                document.getElementById('decisionText').textContent = decision;
                document.getElementById('decisionText').className = `decision-text ${decisionClass}`;

                // Update request details
                document.getElementById('requestDetails').innerHTML = `
                    User: ${userId}<br>
                    Resource: ${resource}<br>
                    Action: ${action}<br>
                    Context: ${context}
                `;

                // Update AI analysis
                document.getElementById('aiAnalysis').innerHTML = `
                    ‚úÖ User behavior analysis: Normal patterns<br>
                    ‚úÖ Risk assessment: Low risk (${Math.random().toFixed(2)})<br>
                    ‚úÖ Context evaluation: ${context === 'trusted' ? 'Trusted environment' : 'Additional verification needed'}<br>
                    ‚úÖ Trust score: ${(Math.random() * 0.3 + 0.7).toFixed(2)}
                `;

                // Update applied rules
                document.getElementById('appliedRules').innerHTML = `
                    Rule #1: ${resource} access for ${context} users<br>
                    Rule #2: ${action} permissions for user role<br>
                    Rule #3: Context-based access control
                `;

                // Update decision factors
                const factors = context === 'trusted' ? `
                    Trust Level: Verified ‚úÖ<br>
                    Risk Score: Low (0.2) ‚úÖ<br>
                    Context: Appropriate ‚úÖ<br>
                    Behavior: Normal ‚úÖ
                ` : `
                    Trust Level: Requires verification ‚ö†Ô∏è<br>
                    Risk Score: Medium (0.6) ‚ö†Ô∏è<br>
                    Context: Needs review ‚ö†Ô∏è<br>
                    Behavior: Monitor closely ‚ö†Ô∏è
                `;

                document.getElementById('decisionFactors').innerHTML = factors;
            }

            editRule(ruleId) {
                this.showNotification(`Editing rule ${ruleId}`, 'info');
            }

            testRule(ruleId) {
                this.showNotification(`Testing rule ${ruleId}`, 'info');
            }

            generateSafeDefaults() {
                this.showNotification('Generating AI-chosen safe defaults...', 'info');
            }

            analyzePatterns() {
                this.showNotification('Analyzing access patterns...', 'info');
            }

            createCustomRule() {
                this.showNotification('Opening custom rule creation...', 'info');
            }

            showNotification(message, type) {
                const notification = document.getElementById('notification');
                const notificationMessage = document.getElementById('notificationMessage');

                notificationMessage.textContent = message;
                notification.className = `notification ${type}`;
                notification.style.display = 'block';

                // Hide after 5 seconds
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 5000);
            }
        }

        // Initialize dashboard when page loads
        let permissionsDashboard;
        document.addEventListener('DOMContentLoaded', () => {
            permissionsDashboard = new PermissionsDashboard();
        });

        // Make globally available for onclick handlers
        window.simulateRequest = function() {
            permissionsDashboard.simulateRequest();
        };
    </script>
</body>
</html>